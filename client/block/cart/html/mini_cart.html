{% load tags %}

<div class="mini_cart change_length {{ type_mini_cart }}">
    <div>

        <div class="mini_cart-shell"></div>

        <div class="mini_cart-title change_length-button">
            <button class="mini_cart-icon button is-icon is-right" type="button">
                <span class="button-icon img-shopping_cart"> &nbsp; </span>
            </button>

            <span class="mini_cart-title-date">
                {{ item.payment.date }}&nbsp;-&nbsp;
            </span>

            <span class="mini_cart-title-name">
                {% if button_address_name == 'root_address' and item.fullname %}
                    {{ item.fullname }}
                {% else %}
                    {{ item.payment.user }}
                {% endif %}
            </span>

        </div>

        <div class="mini_cart-field_list">

            {% if button_address_name == 'root_address' and item.fullname %}

                {% for selected in item.products %}
                    <div class="mini_cart-product">
                        <span>{{ selected.product }}</span>
                        <span>x {{ selected.number }}</span>
                    </div>
                {% endfor %}

            {% else %}

                <div class="mini_cart-message">
                    <span>Empty</span>
                </div>

            {% endif %}

        </div>

        <div>

            <div class="mini_cart-additional_info">
                <span> {{ item.payment.service }} </span>
                <span class="is-float-right"> {{ item.payment.total_price }} {{ item.payment.currency }} </span>
            </div>


            {% if type_mini_cart == 'for-root' %}

                <div class="is-right-inside">

                    <div class="tooltip align-left align-top">
                        <button class="button tooltip_button"
                                data-name="description">
                            Assign
                        </button>

                        <div class="tooltip-options">

                            <button class="button is-text_icon post_button"
                                    data-name="set_cart_status_pending"
                                    data-action="assign"
                                    data-value="pending"
                                    data-other_1="index:{{ item.payment.pk }}"
                                    data-reload="ground">
                                <span class="button-text">
                                    Pending
                                </span>
                                <span class="button-icon">
                                    {% if request.session.root_payment_status == 'pending' %}
                                        &#10004;
                                    {% endif %}
                                </span>
                            </button>

                            <button class="button is-text_icon post_button"
                                    data-name="set_cart_status_pending"
                                    data-action="assign"
                                    data-value="late_payment"
                                    data-other_1="index:{{ item.payment.pk }}"
                                    data-reload="ground">
                                <span class="button-text">
                                    Late payment
                                </span>
                                <span class="button-icon">
                                    {% if request.session.root_payment_status == 'late_payment' %}
                                        &#10004;
                                    {% endif %}
                                </span>
                            </button>

                            <button class="button is-text_icon post_button"
                                    type="button"
                                    data-name="set_cart_status_internal"
                                    data-action="assign"
                                    data-value="internal"
                                    data-other_1="index:{{ item.payment.pk }}"
                                    data-reload="ground">
                                <span class="button-text">
                                    Internal
                                </span>
                                <span class="button-icon">
                                    {% if request.session.root_payment_status == 'internal' %}
                                        &#10004;
                                    {% endif %}
                                </span>
                            </button>

                            <button class="button is-text_icon post_button"
                                    type="button"
                                    data-name="set_cart_status_external"
                                    data-action="assign"
                                    data-value="external"
                                    data-other_1="index:{{ item.payment.pk }}"
                                    data-reload="ground">
                                <span class="button-text">
                                    External
                                </span>
                                <span class="button-icon">
                                    {% if request.session.root_payment_status == 'external' %}
                                        &#10004;
                                    {% endif %}
                                </span>
                            </button>

                            <button class="button is-text_icon post_button"
                                    type="button"
                                    data-name="set_cart_status_completed"
                                    data-action="assign"
                                    data-value="completed"
                                    data-other_1="index:{{ item.payment.pk }}"
                                    data-reload="ground">
                                <span class="button-text">
                                    Completed
                                </span>
                                <span class="button-icon">
                                    {% if request.session.root_payment_status == 'completed' %}
                                        &#10004;
                                    {% endif %}
                                </span>
                            </button>

                        </div>
                    </div>

                    <div class="tooltip align-right align-top">
                        <button class="button tooltip_button"
                                data-name="description">
                            More
                        </button>

                        <div class="tooltip-options">
                            <button class="button dialog_button"
                                    type="button"
                                    data-type="prompt"
                                    data-name="deadline"
                                    data-value="{{ item.payment.pk }}">
                                Deadline/Reminder
                            </button>
                            <button class="button dialog_button"
                                    type="button"
                                    data-type="prompt"
                                    data-name="note"
                                    data-value="{{ item.payment.pk }}">
                                Note
                            </button>
                            <button class="button dialog_button"
                                    type="button"
                                    data-type="alert"
                                    data-name="{{ button_address_name }}"
                                    data-value="{{ item.payment.pk }}">
                                Show addresses
                            </button>
	                        <button class="button dialog_button"
	                                type="button"
	                                data-type="prompt"
	                                data-name="send_email"
	                                data-value="{{ item.payment.pk }}">
		                        Send e-mail
	                        </button>
                            <a class="button" href="{% url 'pdf.invoice' full=True pk=item.payment.pk %}">
                                Get invoice
                            </a>
                        </div>
                    </div>

                </div>

            {% endif %}

        </div>

    </div>
</div><!-- form_block fields -->